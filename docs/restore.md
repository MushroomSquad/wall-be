# Восстановление из резервной копии

**Language / Язык**: [English](en/restore.md) | [Русский](restore.md)

Этот документ описывает процесс восстановления баз данных из резервных копий с использованием wall-be.

## Предварительные требования

Перед выполнением операции восстановления:

1. Остановите службу базы данных, если она запущена
2. Убедитесь, что у вас есть достаточно дискового пространства
3. Проверьте, что у вас есть права на запись в директорию данных базы данных
4. Убедитесь, что конфигурация wall-be настроена правильно

## Базовое восстановление

### Восстановление из последней резервной копии

Чтобы восстановить базу данных из последней доступной резервной копии:

```bash
./wall-be.sh mysql restore --name LATEST  # Для MySQL
# или
./wall-be.sh postgresql restore --name LATEST  # Для PostgreSQL
```

### Восстановление из конкретной резервной копии

Вы можете восстановить из конкретной резервной копии, указав её имя:

```bash
./wall-be.sh mysql restore --name mysql_backup_20230415_120000
# или
./wall-be.sh postgresql restore --name base_000000010000000000000001
```

Чтобы получить список доступных резервных копий, используйте команду list:

```bash
./wall-be.sh mysql list
```

## Расширенные опции восстановления

### Восстановление на определенный момент времени (PITR)

Для PostgreSQL вы можете восстановить на определенный момент времени:

```bash
./wall-be.sh postgresql restore --time "2023-04-15 14:30:00"
```

Это восстановит базу данных до состояния, в котором она была в указанное время, если доступны необходимые WAL-файлы.

### Восстановление в другое местоположение

Для восстановления в другую директорию:

```bash
./wall-be.sh mysql restore --name LATEST --target-dir /path/to/restore/directory
```

### Восстановление с другими параметрами базы данных

Вы можете указать другие параметры базы данных для восстановленной базы данных:

```bash
./wall-be.sh postgresql restore --name LATEST --config-file /path/to/new/postgresql.conf
```

## Проверка восстановления

После восстановления рекомендуется проверить, что база данных функционирует корректно:

```bash
./wall-be.sh mysql verify --restored
```

Это запустит базовые проверки целостности на восстановленной базе данных.

## Частичное восстановление

### Восстановление конкретных баз данных

Для MySQL вы можете восстановить конкретные базы данных:

```bash
./wall-be.sh mysql restore --name LATEST --databases "db1,db2,db3"
```

### Восстановление конкретных таблиц

Для MySQL вы можете восстановить конкретные таблицы:

```bash
./wall-be.sh mysql restore --name LATEST --database db1 --tables "table1,table2"
```

## Устранение неполадок при восстановлении

Если вы столкнулись с проблемами во время восстановления:

1. Проверьте, что резервная копия существует и доступна
2. Убедитесь, что сервер базы данных остановлен перед восстановлением
3. Убедитесь, что у вас достаточно дискового пространства
4. Проверьте права доступа к целевой директории
5. Просмотрите журналы для подробных сообщений об ошибках

Для более подробного устранения неполадок, обратитесь к [Руководству по устранению неполадок](troubleshooting.md). 